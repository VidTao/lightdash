-- @block_type: explore
-- @model_type: table
-- Orders model mirroring bratrax.production_tables.orders_table

SELECT
    client_id,
    write_key,
    platform,
    order_id,
    customer_id,
    order_name,
    customer_email,
    customer_first_name,
    customer_last_name,
    customer_from_city,
    customer_from_country_code,
    customer_from_state_code,
    tags,
    note,
    discount_codes,
    fulfillment_status,
    source_name,
    source_category,
    created_at,
    cancelled_at,
    event_date,
    event_hour,
    timezone,
    order_revenue,
    gross_revenue,
    discount_amount,
    taxes,
    shipping_price,
    refund_money,
    net_revenue,
    cost_of_goods,
    payment_gateway_costs,
    shipping_costs,
    handling_fees,
    amazon_estimated_fees,
    estimated_profit,
    product_quantity_sold_in_order,
    line_items_skus,
    line_items_titles,
    line_items_vendors,
    line_items_requires_shipping,
    line_items_gift_card,
    line_items_taxable,
    line_items_fulfillment_service,
    total_shipping_price,
    estimated_taxes,
    current_subtotal_price_shop,
    current_subtotal_price_presentment,
    current_subtotal_price_currency,
    current_total_discounts_shop,
    current_total_discounts_presentment,
    current_total_discounts_currency,
    current_total_tax_shop,
    current_total_tax_presentment,
    current_total_tax_currency,
    total_price_shop,
    total_price_presentment,
    total_price_currency,
    total_discounts_shop,
    total_discounts_presentment,
    total_discounts_currency,
    total_line_items_price_shop,
    total_line_items_price_presentment,
    total_line_items_price_currency,
    total_shipping_price_shop,
    total_shipping_price_presentment,
    total_shipping_price_currency,
    total_tax_shop,
    total_tax_presentment,
    total_tax_currency,
    refund_ids,
    refund_amounts,
    refund_notes,
    refund_processed_at,
    payment_credit_card_bin,
    payment_credit_card_company,
    payment_credit_card_name,
    payment_credit_card_wallet,
    payment_credit_card_expiration_month,
    payment_credit_card_expiration_year,
    payment_method_name,
    transaction_ids,
    transaction_amounts,
    transaction_kinds,
    transaction_statuses,
    transaction_gateways,
    order_adjustment_ids,
    order_adjustment_amounts,
    order_adjustment_kinds,
    order_adjustment_reasons,
    is_new_customer,
    is_gift_card,
    is_subscription_order,
    is_refund,
    amazon_marketplace_id,
    amazon_fulfillment_channel,
    amazon_fulfillment_status,
    amazon_is_business_order,
    processed_at,
    last_processed_at,
    orders_processed_at,
    DATE(TIMESTAMP_ADD(created_at, INTERVAL 10 HOUR)) as date_plus_10h
FROM
    {{ source('production', 'orders_table') }} 